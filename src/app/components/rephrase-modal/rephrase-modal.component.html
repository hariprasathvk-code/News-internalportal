<div class="rephrase-modal">
  <!-- Header -->
  <div class="modal-header">
    <h2>âœï¸ Rephrase with AI</h2>
    <p class="article-title">{{ data.title }}</p>
  </div>

  <!-- Step 1: Selection -->
  <div *ngIf="!hasResults" class="selection-step">
    <h3>Select what to rephrase:</h3>
    
    <div class="checkbox-group">
      <label class="checkbox-item">
        <input type="checkbox" [(ngModel)]="rephraseTitle" [disabled]="isGenerating">
        <div class="checkbox-content">
          <span class="checkbox-label">ğŸ“° Title</span>
          <p class="checkbox-description">Generate improved title based on content</p>
        </div>
      </label>

      <label class="checkbox-item">
        <input type="checkbox" [(ngModel)]="rephraseSummary" [disabled]="isGenerating">
        <div class="checkbox-content">
          <span class="checkbox-label">ğŸ“„ Summary</span>
          <p class="checkbox-description">Create better summary from content</p>
        </div>
      </label>

      <label class="checkbox-item">
        <input type="checkbox" [(ngModel)]="rephraseContent" [disabled]="isGenerating">
        <div class="checkbox-content">
          <span class="checkbox-label">ğŸ“ Content</span>
          <p class="checkbox-description">Improve and develop full content</p>
        </div>
      </label>
    </div>

    <!-- Loading State -->
    <div *ngIf="isGenerating" class="loading-state">
      <div class="spinner"></div>
      <p>ğŸ¤– AI is analyzing your content...</p>
      <div class="progress-items">
        <div class="progress-item" *ngIf="rephraseTitle">
          <span class="icon">â³</span> Generating Title...
        </div>
        <div class="progress-item" *ngIf="rephraseSummary">
          <span class="icon">â³</span> Generating Summary...
        </div>
        <div class="progress-item" *ngIf="rephraseContent">
          <span class="icon">â³</span> Improving Content...
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="modal-actions">
      <button class="btn-cancel" (click)="cancel()" [disabled]="isGenerating">
        Cancel
      </button>
      <button 
        class="btn-generate" 
        (click)="generateImprovements()" 
        [disabled]="!canGenerate || isGenerating">
        <span *ngIf="!isGenerating">ğŸ¤– Generate Improvements</span>
        <span *ngIf="isGenerating">â³ Generating...</span>
      </button>
    </div>
  </div>

  <!-- Step 2: Results & Comparison -->
  <div *ngIf="hasResults" class="results-step">
    <h3>Review AI Improvements</h3>

    <!-- Title Comparison -->
    <div *ngIf="rephraseTitle" class="comparison-section">
      <h4>ğŸ“° Title Comparison</h4>
      
      <div class="comparison-box">
        <div class="original">
          <span class="label">Original:</span>
          <p>{{ originalTitle }}</p>
        </div>
        
        <div class="improved">
          <span class="label">AI Improved: âœ¨</span>
          <p>{{ improvedTitle }}</p>
        </div>
      </div>

      <div class="decision-buttons">
        <button 
          class="btn-accept" 
          [class.accepted]="titleAccepted === true"
          (click)="acceptTitle()"
          [disabled]="isProcessing">
          âœ… Accept
        </button>
        <button 
          class="btn-reject" 
          [class.rejected]="titleAccepted === false"
          (click)="rejectTitle()"
          [disabled]="isProcessing">
          âŒ Reject
        </button>
      </div>
    </div>

    <!-- Summary Comparison -->
    <div *ngIf="rephraseSummary" class="comparison-section">
      <h4>ğŸ“„ Summary Comparison</h4>
      
      <div class="comparison-box">
        <div class="original">
          <span class="label">Original: ({{ originalSummary.length }} chars)</span>
          <p class="scrollable">{{ originalSummary }}</p>
        </div>
        
        <div class="improved">
          <span class="label">AI Improved: âœ¨ ({{ improvedSummary.length }} chars)</span>
          <p class="scrollable">{{ improvedSummary }}</p>
        </div>
      </div>

      <div class="decision-buttons">
        <button 
          class="btn-accept" 
          [class.accepted]="summaryAccepted === true"
          (click)="acceptSummary()"
          [disabled]="isProcessing">
          âœ… Accept
        </button>
        <button 
          class="btn-reject" 
          [class.rejected]="summaryAccepted === false"
          (click)="rejectSummary()"
          [disabled]="isProcessing">
          âŒ Reject
        </button>
      </div>
    </div>

    <!-- Content Comparison -->
    <div *ngIf="rephraseContent" class="comparison-section">
      <h4>ğŸ“ Content Comparison</h4>
      
      <div class="comparison-box">
        <div class="original">
          <span class="label">Original: ({{ originalContent.length }} chars)</span>
          <textarea readonly class="content-area">{{ originalContent }}</textarea>
        </div>
        
        <div class="improved">
          <span class="label">AI Improved: âœ¨ ({{ improvedContent.length }} chars)</span>
          <textarea readonly class="content-area">{{ improvedContent }}</textarea>
        </div>
      </div>

      <div class="decision-buttons">
        <button 
          class="btn-accept" 
          [class.accepted]="contentAccepted === true"
          (click)="acceptContent()"
          [disabled]="isProcessing">
          âœ… Accept
        </button>
        <button 
          class="btn-reject" 
          [class.rejected]="contentAccepted === false"
          (click)="rejectContent()"
          [disabled]="isProcessing">
          âŒ Reject
        </button>
      </div>
    </div>

    <!-- Final Actions -->
    <div class="modal-actions">
      <button class="btn-cancel" (click)="cancel()" [disabled]="isProcessing">
        Cancel
      </button>
      <button 
        class="btn-confirm" 
        (click)="confirmChanges()" 
        [disabled]="!hasAcceptedChanges || isProcessing">
        <span *ngIf="!isProcessing">ğŸ’¾ Confirm & Update</span>
        <span *ngIf="isProcessing">â³ Updating...</span>
      </button>
    </div>
  </div>
</div>
