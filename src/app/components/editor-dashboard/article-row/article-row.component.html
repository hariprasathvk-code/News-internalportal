<div class="article-row">
  <!-- Media Preview Section -->
  <div class="media-list" *ngIf="article.MediaUrls?.length; else noMedia">
    <ng-container *ngFor="let url of article.MediaUrls">
      <img *ngIf="isImage(url)" [src]="url" class="article-thumb" alt="Media" />
      <video *ngIf="isVideo(url)" [src]="url" class="article-thumb" controls></video>
      <a *ngIf="!isImage(url) && !isVideo(url)" [href]="url" target="_blank" class="file-link">
        üìé {{ url.split('/').pop() }}
      </a>
    </ng-container>
  </div>
  <ng-template #noMedia>
    <span class="article-thumb noimg">No media</span>
  </ng-template>

  <div class="info">
    <div class="main-row">
      <span class="title"><b>{{ article.Title }}</b></span>
      <span class="category">{{ article.Category }}</span>
      <span class="subcategory">{{ article.SubCategory }}</span>
      <span class="status" [ngClass]="{
        'status-submitted': article.Status === 'Submitted',
        'status-approved': article.Status === 'Approved by AI' || article.Status === 'Approved',
        'status-rejected': article.Status === 'Rejected by AI' || article.Status === 'Rejected'
      }">{{ article.Status }}</span>
    </div>

    <div class="meta">
      <span><strong>Author:</strong> {{ article.Author }}</span>
      <span><strong>Type:</strong> {{ article.NewsType }}</span>
      <span><strong>NewsId:</strong> {{ article.NewsId }}</span>
    </div>

    <div class="meta">
      <span><strong>Region:</strong> {{ article.Region }}</span>
      <span><strong>Country:</strong> {{ article.Country }}</span>
      <span><strong>State:</strong> {{ article.State }}</span>
      <span><strong>City:</strong> {{ article.City }}</span>
    </div>

    <div class="meta">
      <span><strong>Date:</strong> {{ article.SubmittedDateTime }}</span>
    </div>

    <div class="summary"><b>Summary:</b> {{ article.Summary }}</div>
    <div class="content"><b>Content:</b>
      <ng-container *ngIf="!isContentExpanded">
        {{ article.Content | slice:0:180 }}
        <span *ngIf="article.Content && article.Content.length > 180">...</span>
        <a
          *ngIf="article.Content && article.Content.length > 180"
          href="#"
          (click)="toggleContentExpand(); $event.preventDefault()">See more</a>
      </ng-container>
      <ng-container *ngIf="isContentExpanded">
        {{ article.Content }}
        <a href="#" (click)="toggleContentExpand(); $event.preventDefault()">See less</a>
      </ng-container>
    </div>

    <div class="actions">

      <button
        (click)="approveArticle(article)"
        class="approve-btn"
        [disabled]="isValidating || isSaving || isApproving || isRejecting">
        <span *ngIf="!isApproving">‚úì Approve</span>
        <span *ngIf="isApproving">‚è≥ Approving...</span>
      </button>

      <button
        (click)="rejectArticle(article)"
        class="reject-btn"
        [disabled]="isValidating || isSaving || isApproving || isRejecting">
        <span *ngIf="!isRejecting">‚úó Reject</span>
        <span *ngIf="isRejecting">‚è≥ Rejecting...</span>
      </button>
      
      <!-- ‚úÖ NEW: Check with AI button -->
      <button
        (click)="checkArticleWithAI(article)"
        class="ai-btn"
        [disabled]="isValidating || article.Status === 'Approved by AI' || article.Status === 'Rejected by AI'">
        <span *ngIf="!isValidating">ü§ñ Check with AI</span>
        <span *ngIf="isValidating">‚è≥ Checking...</span>
      </button>
      
      <!-- ‚úÖ NEW: Rephrase with AI button -->
      <button 
        (click)="rephraseArticle(article)" 
        class="rephrase-btn"
        [disabled]="isValidating || isRejecting || isApproving">
        ‚úèÔ∏è Rephrase with AI
      </button>

      <button
        (click)="editMode = !editMode"
        class="edit-btn"
        [disabled]="isValidating">
        ‚úèÔ∏è Edit
      </button>
    </div>

    <!-- Inline Editor -->
    <div *ngIf="editMode" class="edit-form">
      <h4>Edit Article</h4>
      
      <label>Title:</label>
      <input [(ngModel)]="article.Title" />

      <label>Summary:</label>
      <textarea 
        [(ngModel)]="article.Summary" 
        rows="6"
        class="summary-textarea"></textarea>

      <label>Content:</label>
      <textarea 
        [(ngModel)]="article.Content" 
        rows="12"
        class="content-textarea"></textarea>

      <label>Category:</label>
      <input [(ngModel)]="article.Category" />

      <label>Status:</label>
      <input [(ngModel)]="article.Status" />

      <div class="edit-actions">
        <button (click)="saveEdit()" class="save-btn">üíæ Save</button>
        <button (click)="editMode = false" class="cancel-btn">‚úï Cancel</button>
      </div>
    </div>
  </div>
</div>