<div class="app-layout">
  <app-editor-sidebar (sectionChange)="onSidebarSection($event)"></app-editor-sidebar>
 
  <div class="container">
    <div class="header-row">
      <div>
        <h1>üì∞ News Editor Dashboard</h1>
        <div class="subtitle">Manage and review news articles and advertisements</div>
      </div>
      <div class="header-actions">
        <button
          class="ai-btn-all"
          (click)="checkAllWithAI()"
          [disabled]="isValidatingAll">
          <span *ngIf="!isValidatingAll">ü§ñ Check All with AI</span>
          <span *ngIf="isValidatingAll">‚è≥ Validating All...</span>
        </button>
        <button class="logout-btn" (click)="logout()">üö™ Logout</button>
      </div>
    </div>
 
    <div class="summary-row">
      <app-card-summary
        *ngFor="let card of summaryCards"
        [label]="card.label"
        [value]="card.value"
        [note]="card.note"
        [change]="card.change">
      </app-card-summary>
    </div>
 
    <!-- News Submissions Section -->
    <ng-container *ngIf="selectedSection === 'news'">
      <app-article-list
        [articles]="articles"
        (validateArticle)="onValidateSingleArticle($event)"
        
        (approveArticle)="onApproveArticle($event)"
        (rejectArticle)="onRejectArticle($event)">
      </app-article-list>
    </ng-container>
 
    <!-- Ads Section -->
    <ng-container *ngIf="selectedSection === 'ads'">
      <app-ad-submission-list
  [ads]="ads"
  (checkAi)="checkAiValidation($event)">
</app-ad-submission-list>

    </ng-container>

    <!-- ‚úÖ Rejected Articles Section with Loading State -->
<ng-container *ngIf="selectedSection === 'rejected'">
  <div class="rejected-articles-section">
    <h2>üóëÔ∏è Rejected Articles</h2>
    <p class="section-desc">View all rejected articles with rejection reasons</p>
    
    <!-- ‚úÖ Loading State -->
    <div *ngIf="isLoadingRejected" class="loading-state">
      <div class="spinner"></div>
      <p>Loading rejected articles...</p>
    </div>
    
    <!-- ‚úÖ No Articles State -->
    <div *ngIf="!isLoadingRejected && rejectedArticles.length === 0" class="no-articles">
      <p>üì≠ No rejected articles found</p>
    </div>

    <!-- ‚úÖ Articles List -->
    <div *ngIf="!isLoadingRejected && rejectedArticles.length > 0" class="rejected-articles-list">
      <div *ngFor="let article of rejectedArticles" class="rejected-article-card">
        <!-- Media Preview -->
        <div class="media-section">
          <div *ngIf="article.MediaUrls && article.MediaUrls.length > 0" class="media-list">
            <ng-container *ngFor="let url of article.MediaUrls">
              <img *ngIf="isImage(url)" [src]="url" class="article-thumb" alt="Media" />
              <video *ngIf="isVideo(url)" [src]="url" class="article-thumb" controls></video>
            </ng-container>
          </div>
          <div *ngIf="!article.MediaUrls || article.MediaUrls.length === 0" class="no-media">
            üì∑ No media
          </div>
        </div>

        <!-- Article Info -->
        <div class="article-info">
          <h3 class="article-title">{{ article.Title }}</h3>
          
          <div class="meta-row">
            <span class="badge category">{{ article.Category }}</span>
            <span class="badge subcategory">{{ article.SubCategory }}</span>
            <span class="badge status-rejected">Rejected</span>
          </div>

          <div class="meta-details">
            <p><strong>Author:</strong> {{ article.Author }}</p>
            <p><strong>News ID:</strong> {{ article.NewsId }}</p>
            <p><strong>Type:</strong> {{ article.NewsType }}</p>
            <p><strong>Submitted:</strong> {{ article.SubmittedDateTime }}</p>
            <p><strong>Rejected:</strong> {{ article.RejectedAt ? (article.RejectedAt | date:'medium') : 'N/A' }}</p>
          </div>

          <div class="summary-section">
            <strong>Summary:</strong>
            <p>{{ article.Summary }}</p>
          </div>

          <div class="content-section">
            <strong>Content:</strong>
            <p>{{ article.Content | slice:0:200 }}{{ (article.Content && article.Content.length > 200) ? '...' : '' }}</p>
          </div>

          <!-- Rejection Remark -->
          <div class="rejection-remark">
            <strong>‚ùå Rejection Reason:</strong>
            <p class="remark-text">{{ article.RejectionRemark || 'No remark provided' }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-container>

 
    <!-- AI Insights Section -->
    <ng-container *ngIf="selectedSection === 'ai'">
      <app-ai-insights></app-ai-insights>
    </ng-container>



<div *ngIf="selectedSection === 'category'">
  <div class="category-box-row">
    <button
      *ngFor="let cat of categories"
      (click)="onSelectCategory(cat.value)"
      [class.active]="selectedCategory === cat.value"
      class="category-report-btn">
      <div class="report-icon"></div>
      <span class="report-label">{{ cat.label }}</span>
    </button>
  </div>
  <div *ngIf="selectedCategory">
    <div *ngIf="selectedCategoryNews.length === 0" class="category-news-loading">
      <div class="loading-spinner"></div>
      <p>Loading {{ getCategoryLabel(selectedCategory) }} news.....</p>
    </div>
    <div class="news-card-row">
      <div class="news-report-card" *ngFor="let news of selectedCategoryNews">
        <div class="media-wrapper">
         
          <img *ngIf="isImage(news.MediaFolder)" [src]="news.MediaFolder" alt="News image" width="280" height="170" (error)="onImageError($event)" />

          <video *ngIf="isVideo(news.MediaFolder)" [src]="news.MediaFolder" width="280" height="170" controls></video>
        </div>
        <div class="news-content">
          <h3>{{ news.Title }}</h3>
          <p class="summary">{{ news.Summary || news.Description }}</p>
          <div class="meta">
            <span>{{ news.Author }}</span>
            <span>{{ news.ApprovedDate | date:'short' }}</span>
            <span>{{ news.CategoryName }}</span>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="selectedCategoryNews.length === 0">
      <p></p>
    </div>
  </div>
</div>




    <ng-container *ngIf="selectedSection === 'reports'">
      <app-reports></app-reports>
    </ng-container>

    <!-- ‚úÖ ADDED: User Management Section -->
    <ng-container *ngIf="selectedSection === 'users'">
      <app-user-management></app-user-management>
    </ng-container>
      <ng-container *ngIf="selectedSection === 'leaderboard'">
      <div *ngIf="leaderboardLoading">Loading leaderboard data...</div>
      <app-leaderboard *ngIf="leaderboard" [data]="leaderboard"></app-leaderboard>
    </ng-container>
    <ng-container *ngIf="selectedSection === 'feedback'">
  <!-- Loading state -->
  <div *ngIf="feedbackLoading" class="feedback-loading">
    <span class="spinner"></span> Loading feedbacks...
  </div>

  <!-- Feedback List -->
  <app-feedback-list
    *ngIf="!feedbackLoading"
    [feedbacks]="feedbacks">
  </app-feedback-list>
  </ng-container>


  </div>
</div>
